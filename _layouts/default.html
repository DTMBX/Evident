<!doctype html>
<!-- htmlhint-disable -->
<html lang="en"{% if page.dir %} dir="{{ page.dir }}"{% endif %}>
  <head>
    {%- comment -%} Meta tags and SEO - Load First {%- endcomment -%}
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#c41e3a" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#1f2937" media="(prefers-color-scheme: dark)" />
    <meta name="color-scheme" content="light dark" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>{{ page.title | default: site.title | default: 'BarberX Legal Technologies' }} | AI-Powered Legal Research</title>
    
    {%- comment -%} Core Web Vitals & Performance Hints {%- endcomment -%}
    <link rel="preload" href="{{ '/assets/css/style.css' | relative_url }}" as="style" />
    <link rel="preload" href="{{ '/assets/js/main-upgraded.js' | relative_url }}" as="script" />
    <link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" />
    
    {%- comment -%} SEO & Social Meta Tags {%- endcomment -%}
    {% include components/seo-meta.html %}
    {% include seo.html %}
    {% include schema.html %}
    
    {%- comment -%} PWA Manifest {%- endcomment -%}
    <link rel="manifest" href="{{ '/manifest.json' | relative_url }}" />
    
    {%- comment -%} Icons - PWA & iOS {%- endcomment -%}
    <link rel="icon" type="image/png" sizes="32x32" href="{{ '/assets/images/favicon-32.png' | relative_url }}" />
    <link rel="icon" type="image/png" sizes="16x16" href="{{ '/assets/images/favicon-16.png' | relative_url }}" />
    <link rel="shortcut icon" href="{{ '/favicon.ico' | relative_url }}" />
    
    {%- comment -%} Apple Touch Icons {%- endcomment -%}
    <link rel="apple-touch-icon" href="{{ '/assets/images/apple-touch-icon.png' | relative_url }}" />
    <link rel="apple-touch-icon" sizes="152x152" href="{{ '/assets/images/apple-touch-icon-152.png' | relative_url }}" />
    <link rel="apple-touch-icon" sizes="167x167" href="{{ '/assets/images/apple-touch-icon-167.png' | relative_url }}" />
    <link rel="apple-touch-icon" sizes="180x180" href="{{ '/assets/images/apple-touch-icon-180.png' | relative_url }}" />
    
    {%- comment -%} Preconnect to Google Fonts for Performance {%- endcomment -%}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://us.i.posthog.com" crossorigin>
    
    {%- comment -%} DNS Prefetch for faster external resources {%- endcomment -%}
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://unpkg.com">
    <link rel="dns-prefetch" href="https://api.barberx.info">
    <link rel="dns-prefetch" href="https://js.stripe.com">
    
    {%- comment -%} Critical CSS - Base Styles (Load First) {%- endcomment -%}
    <link rel="stylesheet" href="{{ '/assets/css/responsive-system.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ '/assets/css/brand-tokens.css' | relative_url }}" />
    
    {%- comment -%} BarberX Golden Age Branding - Core Theme {%- endcomment -%}
    <link rel="stylesheet" href="{{ '/assets/css/barberx-golden-age.css' | relative_url }}" />
    
    {%- comment -%} Google Fonts - 1920's Typography (Non-blocking) {%- endcomment -%}
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet"></noscript>
    
    {%- comment -%} Component Styles {%- endcomment -%}
    <link rel="stylesheet" href="{{ '/assets/css/components/barber-branding.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ '/assets/css/components/ux-enhancements.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ '/assets/css/components/premium-header.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ '/assets/css/components/connect-compliance-footer.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ '/assets/css/components/mobile-nav-drawer.css' | relative_url }}" />
    
    {%- comment -%} Accessibility Enhancements - WCAG 2.1 Level AA {%- endcomment -%}
    <link rel="stylesheet" href="{{ '/assets/css/accessibility.css' | relative_url }}" />
    
    {%- comment -%} Animation System {%- endcomment -%}
    <link rel="stylesheet" href="{{ '/assets/css/enhanced-animations.css' | relative_url }}" />
    
    {%- comment -%} Page-specific stylesheet from front matter {%- endcomment -%}
    {% if page.stylesheet %}
    <link rel="stylesheet" href="{{ page.stylesheet | relative_url }}" />
    {% endif %}
    
    {%- comment -%} Case cards component - load when using case-cards {%- endcomment -%}
    {% if page.permalink == '/cases/' or page.collection == 'cases' or page.layout == 'case' or page.layout == 'case-enhanced' %}
    <link rel="stylesheet" href="{{ '/assets/css/components/case-cards.css' | relative_url }}" />
    {% endif %}
    
    {%- comment -%} Page-specific CSS based on layout type {%- endcomment -%}
    {% if page.layout == 'case' or page.layout == 'case-enhanced' %}
    <link rel="stylesheet" href="{{ '/assets/css/pages/cases.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ '/assets/css/pages/case-enhanced.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ '/assets/css/pages/case-analysis.css' | relative_url }}" />
    {% elsif page.layout == 'essay' %}
    <link rel="stylesheet" href="{{ '/assets/css/pages/essays.css' | relative_url }}" />
    {% elsif page.layout == 'article' %}
    <link rel="stylesheet" href="{{ '/assets/css/pages/articles.css' | relative_url }}" />
    {% endif %}
    
    {%- comment -%} Collection-based CSS {%- endcomment -%}
    {% if page.collection == 'cases' %}
    <link rel="stylesheet" href="{{ '/assets/css/pages/cases.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ '/assets/css/pages/case-enhanced.css' | relative_url }}" />
    {% elsif page.collection == 'essays' %}
    <link rel="stylesheet" href="{{ '/assets/css/pages/essays.css' | relative_url }}" />
    {% elsif page.collection == 'opra' %}
    <link rel="stylesheet" href="{{ '/assets/css/pages/opra.css' | relative_url }}" />
    {% endif %}
    
    {%- comment -%} Body class-based CSS {%- endcomment -%}
    {% if page.body_class contains 'case' %}
    <link rel="stylesheet" href="{{ '/assets/css/pages/cases.css' | relative_url }}" />
    {% endif %}
    
    {%- comment -%} Custom CSS per page {%- endcomment -%}
    {% unless page.hide_barber_pole %}
    <link rel="stylesheet" href="{{ '/assets/css/components/barber-pole-spinner.css' | relative_url }}" />
    {% endunless %}
    
    {% if page.extra_css %}
      {% for css in page.extra_css %}
    <link rel="stylesheet" href="{{ css | relative_url }}" />
      {% endfor %}
    {% endif %}
    
    {%- comment -%} Page-specific head content {%- endcomment -%}
    {% if page.custom_head %}{{ page.custom_head }}{% endif %}
  </head>

  <body{% if page.body_class %} class="{{ page.body_class }}"{% endif %}{% if page.data_theme %} data-theme="{{ page.data_theme }}"{% endif %} data-layout="{{ page.layout | default: 'default' }}"{% if page.collection %} data-collection="{{ page.collection }}"{% endif %}>
    
    {%- comment -%} Accessibility Skip Links {%- endcomment -%}
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <a href="#navigation" class="skip-link">Skip to navigation</a>
    
    {%- comment -%} Reading Progress Bar {%- endcomment -%}
    {% unless page.hide_progress_bar %}
    {% include components/reading-progress.html %}
    {% endunless %}
    
    {%- comment -%} Skip to main content link for accessibility {%- endcomment -%}
    <a href="#main-content" class="skip-to-content">Skip to main content</a>

    {%- comment -%} Cookie Consent Banner {%- endcomment -%}
    {% include components/cookie-consent.html %}

    {%- comment -%} Maintenance banner - sitewide {%- endcomment -%}
    {% if site.maintenance_mode or page.maintenance_banner %}
    {% include components/banners/maintenance-banner.html %}
    {% endif %}

    {%- comment -%} Header navigation {%- endcomment -%}
    {% unless page.hide_header %}
      {% include header.html %}
    {% endunless %}

    {%- comment -%} Mobile Navigation Drawer {%- endcomment -%}
    {% unless page.hide_header %}
      {% include mobile-nav-drawer.html %}
    {% endunless %}

    {%- comment -%} Main content area with layout-specific classes {%- endcomment -%}
    <main id="main" tabindex="-1"{% if page.main_class %} class="{{ page.main_class }}"{% elsif page.layout == 'case' or page.layout == 'case-enhanced' %} class="case-main"{% elsif page.layout == 'page' %} class="page-main"{% elsif page.layout == 'essay' %} class="essay-main"{% endif %}>
      {{ content }}
    </main>

    {%- comment -%} Footer {%- endcomment -%}
    {% unless page.hide_footer %}
      {% include layout/footer/footer.html %}
    {% endunless %}

    {%- comment -%} Back to Top Button {%- endcomment -%}
    {% unless page.hide_back_to_top %}
    {% include components/back-to-top.html %}
    {% endunless %}

    {%- comment -%} Barber pole spinner - decorative 1920s element (hidden on homepage which has its own in hero) {%- endcomment -%}
    {% unless page.hide_barber_pole or page.url == '/' %}
      {% include components/barber-pole-spinner.html position=page.barber_pole_position size=page.barber_pole_size show_on=page.barber_pole_show_on %}
    {% endunless %}

    {%- comment -%} JavaScript includes {%- endcomment -%}
    {% if page.extra_js %}
      {% for js in page.extra_js %}
    <script src="{{ js | relative_url }}" defer></script>
      {% endfor %}
    {% endif %}
    
    {%- comment -%} Layout-specific JavaScript {%- endcomment -%}
    {% if page.layout == 'case' or page.layout == 'case-enhanced' %}
    <script src="{{ '/assets/js/case-nav.js' | relative_url }}" defer></script>
    <script src="{{ '/assets/js/docket-navigator.js' | relative_url }}" defer></script>
    {% endif %}
    
    {%- comment -%} UX Enhancements JavaScript {%- endcomment -%}
    <script src="{{ '/assets/js/ux-enhancements.js' | relative_url }}" defer></script>
    <script src="{{ '/assets/js/premium-header.js' | relative_url }}" defer></script>
    <script src="{{ '/assets/js/mobile-nav-drawer.js' | relative_url }}" defer></script>
    <script src="{{ '/assets/js/early-access-form.js' | relative_url }}" defer></script>
    
    {%- comment -%} Enhanced Animation & Theme System {%- endcomment -%}
    <script src="{{ '/assets/js/enhanced-animations.js' | relative_url }}" defer></script>
    <script src="{{ '/assets/js/theme-system.js' | relative_url }}" defer></script>
    
    {%- comment -%} Main site JavaScript {%- endcomment -%}
    {% unless page.no_main_js %}
    <script src="{{ '/assets/js/main-upgraded.js' | relative_url }}" defer></script>
    {% endunless %}
    
    {%- comment -%} Page-specific inline scripts {%- endcomment -%}
    {% if page.custom_js %}
    <script>
      {{ page.custom_js }}
    </script>
    {% endif %}

    {%- comment -%} Analytics & Performance Tracking {%- endcomment -%}
    {% include components/analytics.html %}

    {%- comment -%} Performance: Instant Page Prefetching - preloads links on hover {%- endcomment -%}
    <script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module" integrity="sha384-jnZyxPjiipYXnSU0ber8UYWAqZDwpfz/ejKNzLMFwLT3fZKTlY8ICcVPvC+qTnPW" crossorigin="anonymous"></script>

    {%- comment -%} AOS - Animate on Scroll Library {%- endcomment -%}
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        AOS.init({
          duration: 600,
          easing: 'ease-out-cubic',
          once: true,
          offset: 50,
          disable: window.matchMedia('(prefers-reduced-motion: reduce)').matches
        });
      });
    </script>

  </body>
</html>
