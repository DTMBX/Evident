{%- comment -%} COMMENTS SYSTEM INTEGRATION Supports Disqus, Utterances (GitHub
Issues), and Giscus (GitHub Discussions) Configure in _config.yml with
comments_provider {%- endcomment -%} {% if site.comments_enabled and
page.comments != false %}
<section
  class="comments-section animate-fade-in-up"
  style="
  margin: {{ include.margin | default: '4rem 0 2rem' }};
  padding: 2rem;
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: var(--radius-lg, 12px);
"
>
  <h2
    class="comments-title"
    style="
      font-size: 1.75rem;
      margin: 0 0 1.5rem 0;
      color: var(--color-text-primary, white);
      display: flex;
      align-items: center;
      gap: 0.75rem;
    "
  >
    <svg
      width="28"
      height="28"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
    </svg>
    Comments
  </h2>

  <div id="comments-container">
    {% if site.comments_provider == 'disqus' %}
    <!-- Disqus Comments -->
    <div id="disqus_thread"></div>
    <script>
      var disqus_config = function () {
        this.page.url = "{{ page.url | absolute_url }}";
        this.page.identifier = "{{ page.id | default: page.url }}";
        this.page.title = "{{ page.title }}";
      };

      (function () {
        var d = document,
          s = d.createElement("script");
        s.src = "https://{{ site.disqus_shortname }}.disqus.com/embed.js";
        s.setAttribute("data-timestamp", +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>
      Please enable JavaScript to view the
      <a
        href="https://disqus.com/?ref_noscript"
        style="color: var(--color-accent)"
        >comments powered by Disqus.</a
      >
    </noscript>

    {% elsif site.comments_provider == 'utterances' %}
    <!-- Utterances (GitHub Issues) Comments -->
    <script
      src="https://utteranc.es/client.js"
      repo="{{ site.utterances_repo }}"
      issue-term="{{ site.utterances_issue_term | default: 'pathname' }}"
      label="{{ site.utterances_label | default: 'comment' }}"
      theme="{{ site.utterances_theme | default: 'github-dark' }}"
      crossorigin="anonymous"
      async
    ></script>

    {% elsif site.comments_provider == 'giscus' %}
    <!-- Giscus (GitHub Discussions) Comments -->
    <script
      src="https://giscus.app/client.js"
      data-repo="{{ site.giscus_repo }}"
      data-repo-id="{{ site.giscus_repo_id }}"
      data-category="{{ site.giscus_category }}"
      data-category-id="{{ site.giscus_category_id }}"
      data-mapping="{{ site.giscus_mapping | default: 'pathname' }}"
      data-strict="{{ site.giscus_strict | default: '0' }}"
      data-reactions-enabled="{{ site.giscus_reactions | default: '1' }}"
      data-emit-metadata="0"
      data-input-position="{{ site.giscus_input_position | default: 'bottom' }}"
      data-theme="{{ site.giscus_theme | default: 'dark' }}"
      data-lang="{{ site.giscus_lang | default: 'en' }}"
      data-loading="lazy"
      crossorigin="anonymous"
      async
    ></script>

    {% elsif site.comments_provider == 'custom' %}
    <!-- Custom Comments System -->
    {{ site.custom_comments_code }} {% else %}
    <!-- Fallback: No comments system configured -->
    <div
      style="
        padding: 2rem;
        text-align: center;
        background: rgba(255, 255, 255, 0.03);
        border-radius: var(--radius-md, 8px);
        color: var(--color-text-muted);
      "
    >
      <p style="margin: 0">
        ðŸ’¬ Comments are not configured yet.
        <a
          href="{{ site.repo_url | default: '#' }}/issues/new"
          style="color: var(--color-accent); text-decoration: underline"
        >
          Start a discussion on GitHub
        </a>
      </p>
    </div>
    {% endif %}
  </div>

  <!-- Comments Guidelines (Optional) -->
  {% if site.show_comment_guidelines %}
  <details
    style="
      margin-top: 2rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: var(--radius-md, 8px);
    "
  >
    <summary
      style="cursor: pointer; font-weight: 600; color: var(--color-accent)"
    >
      ðŸ“‹ Comment Guidelines
    </summary>
    <div
      style="
        margin-top: 1rem;
        font-size: 0.95rem;
        line-height: 1.7;
        color: var(--color-text-muted);
      "
    >
      <ul style="margin: 0; padding-left: 1.5rem">
        <li>Be respectful and constructive</li>
        <li>Stay on topic and relevant to the article</li>
        <li>No spam, self-promotion, or off-topic links</li>
        <li>Use proper language and avoid profanity</li>
        <li>Respect others' privacy and opinions</li>
      </ul>
    </div>
  </details>
  {% endif %}
</section>
{% endif %}

<style>
  /* Theme comments to match site style */
  #disqus_thread {
    color-scheme: dark;
  }

  .utterances,
  .giscus {
    max-width: 100%;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .comments-section {
      padding: 1.5rem;
      margin: 3rem 0 1.5rem;
    }

    .comments-title {
      font-size: 1.5rem;
    }
  }
</style>
