<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Console | BarberX Legal Tech</title>
    <link rel="stylesheet" href="/assets/css/legal-tech-platform.css">
    <style>
        body {
            background: var(--bg-color);
            margin: 0;
            padding: 2rem;
        }

        .tool-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .tool-header {
            background: var(--surface-color);
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            border-left: 4px solid var(--accent-blue);
        }

        .api-panel {
            background: var(--surface-color);
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .endpoint-selector {
            display: grid;
            grid-template-columns: 100px 1fr auto;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .method-select {
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-weight: 700;
            background: var(--bg-color);
        }

        .endpoint-input {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-family: 'Courier New', monospace;
        }

        .code-editor {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            min-height: 200px;
            overflow-x: auto;
        }

        .response-panel {
            background: var(--surface-color);
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .response-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
        }

        .status-200 {
            background: #d1fae5;
            color: #065f46;
        }

        .status-400, .status-404 {
            background: #fef3c7;
            color: #92400e;
        }

        .status-500 {
            background: #fee2e2;
            color: #991b1b;
        }

        .quick-examples {
            background: var(--surface-color);
            padding: 2rem;
            border-radius: 12px;
        }

        .example-item {
            padding: 1rem;
            background: var(--bg-color);
            border-radius: 8px;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .example-item:hover {
            background: var(--primary-navy-10);
            transform: translateX(4px);
        }

        .tab-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--border-color);
        }

        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
        }

        .tab.active {
            border-bottom-color: var(--accent-blue);
            color: var(--accent-blue);
            font-weight: 700;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <div class="tool-header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1 style="margin: 0 0 0.5rem 0;">üîå API Console</h1>
                    <p style="margin: 0; color: var(--text-secondary);">Test and explore the BarberX API</p>
                </div>
                <a href="/dashboard" class="btn btn-secondary">‚Üê Back to Dashboard</a>
            </div>
        </div>

        <!-- API Request Panel -->
        <div class="api-panel">
            <h3 style="margin-bottom: 1.5rem;">üì§ Request</h3>

            <div class="tab-container">
                <div class="tab active" onclick="showTab('params')">Parameters</div>
                <div class="tab" onclick="showTab('headers')">Headers</div>
                <div class="tab" onclick="showTab('body')">Body</div>
            </div>

            <div class="endpoint-selector">
                <select class="method-select" id="methodSelect">
                    <option value="GET">GET</option>
                    <option value="POST">POST</option>
                    <option value="PUT">PUT</option>
                    <option value="DELETE">DELETE</option>
                </select>
                <input type="text" class="endpoint-input" id="endpointInput" value="/api/analyses" placeholder="/api/endpoint">
                <button class="btn btn-primary" onclick="sendRequest()">Send Request</button>
            </div>

            <div id="params-tab" class="tab-content active">
                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Query Parameters</label>
                <textarea id="paramsInput" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-family: monospace; min-height: 100px;" placeholder="page=1&#10;per_page=20"></textarea>
            </div>

            <div id="headers-tab" class="tab-content">
                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Headers</label>
                <div class="code-editor" id="headersEditor">
{
  "Content-Type": "application/json",
  "X-API-Key": "your-api-key-here"
}</div>
            </div>

            <div id="body-tab" class="tab-content">
                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Request Body (JSON)</label>
                <div class="code-editor" id="bodyEditor">
{
  "case_number": "ATL-L-002794-25",
  "acquired_by": "Your Name",
  "source": "OPRA Request"
}</div>
            </div>
        </div>

        <!-- Response Panel -->
        <div class="response-panel" id="responsePanel" style="display: none;">
            <div class="response-header">
                <h3 style="margin: 0;">üì• Response</h3>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <span class="status-badge status-200" id="statusBadge">200 OK</span>
                    <span style="font-size: 0.875rem; color: var(--text-secondary);" id="responseTime">152ms</span>
                </div>
            </div>

            <div class="code-editor" id="responseBody">
{
  "total": 3,
  "page": 1,
  "analyses": [...]
}</div>
        </div>

        <!-- Quick Examples -->
        <div class="quick-examples">
            <h3 style="margin-bottom: 1.5rem;">‚ö° Quick Examples</h3>

            <div class="example-item" onclick="loadExample('list')">
                <div style="font-weight: 700; margin-bottom: 0.25rem;">üìã List All Analyses</div>
                <div style="font-size: 0.875rem; color: var(--text-secondary); font-family: monospace;">
                    GET /api/analyses
                </div>
            </div>

            <div class="example-item" onclick="loadExample('get')">
                <div style="font-weight: 700; margin-bottom: 0.25rem;">üîç Get Analysis Details</div>
                <div style="font-size: 0.875rem; color: var(--text-secondary); font-family: monospace;">
                    GET /api/analysis/{id}
                </div>
            </div>

            <div class="example-item" onclick="loadExample('upload')">
                <div style="font-weight: 700; margin-bottom: 0.25rem;">üì§ Upload BWC Video</div>
                <div style="font-size: 0.875rem; color: var(--text-secondary); font-family: monospace;">
                    POST /api/upload
                </div>
            </div>

            <div class="example-item" onclick="loadExample('analyze')">
                <div style="font-weight: 700; margin-bottom: 0.25rem;">üöÄ Start Analysis</div>
                <div style="font-size: 0.875rem; color: var(--text-secondary); font-family: monospace;">
                    POST /api/analyze
                </div>
            </div>

            <div class="example-item" onclick="loadExample('transcript')">
                <div style="font-weight: 700; margin-bottom: 0.25rem;">üìù Get Transcript</div>
                <div style="font-size: 0.875rem; color: var(--text-secondary); font-family: monospace;">
                    GET /api/transcript/{id}
                </div>
            </div>

            <div class="example-item" onclick="loadExample('discrepancies')">
                <div style="font-weight: 700; margin-bottom: 0.25rem;">‚ö†Ô∏è Get Discrepancies</div>
                <div style="font-size: 0.875rem; color: var(--text-secondary); font-family: monospace;">
                    GET /api/discrepancies/{id}
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + '-tab').classList.add('active');
        }

        function loadExample(type) {
            const examples = {
                'list': {
                    method: 'GET',
                    endpoint: '/api/analyses',
                    params: 'page=1\nper_page=20'
                },
                'get': {
                    method: 'GET',
                    endpoint: '/api/analysis/abc123',
                    params: ''
                },
                'upload': {
                    method: 'POST',
                    endpoint: '/api/upload',
                    body: '{\n  "file": "video.mp4"\n}'
                },
                'analyze': {
                    method: 'POST',
                    endpoint: '/api/analyze',
                    body: '{\n  "upload_id": "abc123",\n  "case_number": "ATL-L-002794-25",\n  "acquired_by": "Your Name",\n  "source": "OPRA Request"\n}'
                },
                'transcript': {
                    method: 'GET',
                    endpoint: '/api/transcript/abc123',
                    params: ''
                },
                'discrepancies': {
                    method: 'GET',
                    endpoint: '/api/discrepancies/abc123',
                    params: ''
                }
            };

            const example = examples[type];
            document.getElementById('methodSelect').value = example.method;
            document.getElementById('endpointInput').value = example.endpoint;
            
            if (example.params) {
                document.getElementById('paramsInput').value = example.params;
            }
            
            if (example.body) {
                document.getElementById('bodyEditor').textContent = example.body;
            }
        }

        function sendRequest() {
            const method = document.getElementById('methodSelect').value;
            const endpoint = document.getElementById('endpointInput').value;

            // Simulate API request
            document.getElementById('responsePanel').style.display = 'block';
            
            // Sample response
            const sampleResponse = {
                total: 3,
                page: 1,
                per_page: 20,
                analyses: [
                    {
                        id: 'abc123',
                        filename: 'BWC_video_1.mp4',
                        case_number: 'ATL-L-002794-25',
                        status: 'completed',
                        created_at: '2025-01-15T14:30:00'
                    }
                ]
            };

            document.getElementById('responseBody').textContent = JSON.stringify(sampleResponse, null, 2);
            document.getElementById('statusBadge').textContent = '200 OK';
            document.getElementById('statusBadge').className = 'status-badge status-200';
            document.getElementById('responseTime').textContent = Math.round(Math.random() * 300) + 'ms';

            // Scroll to response
            document.getElementById('responsePanel').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
