<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Evident.Mobile.Views.ProfilePage"
             Title="Profile">
    
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            
            <!-- Profile Header -->
            <Frame BackgroundColor="{StaticResource Primary}" CornerRadius="10" Padding="20">
                <VerticalStackLayout Spacing="15" HorizontalOptions="Center">
                    <Border StrokeShape="RoundRectangle 50" 
                            Stroke="White" 
                            StrokeThickness="3"
                            HeightRequest="100" 
                            WidthRequest="100">
                        <Image Source="{Binding ProfileImageUrl, TargetNullValue='default_avatar.png'}" 
                               Aspect="AspectFill"/>
                    </Border>
                    
                    <Label Text="{Binding FullName}" 
                           FontSize="24" 
                           FontAttributes="Bold"
                           TextColor="White"
                           HorizontalOptions="Center"/>
                    
                    <Label Text="{Binding Email}" 
                           FontSize="16"
                           TextColor="White"
                           Opacity="0.9"
                           HorizontalOptions="Center"/>
                    
                    <Frame BackgroundColor="White" 
                           Padding="10,5" 
                           CornerRadius="15"
                           HasShadow="False">
                        <Label Text="{Binding TierLevel, StringFormat='{0} Tier'}" 
                               FontSize="14" 
                               FontAttributes="Bold"
                               TextColor="{StaticResource Primary}"/>
                    </Frame>
                </VerticalStackLayout>
            </Frame>

            <!-- Account Info -->
            <Label Text="Account Information" FontSize="20" FontAttributes="Bold"/>
            
            <Frame Padding="15" BackgroundColor="White" BorderColor="LightGray">
                <VerticalStackLayout Spacing="15">
                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                        <Label Grid.Column="0" Text="Member Since:" FontSize="14" TextColor="Gray"/>
                        <Label Grid.Column="1" Text="{Binding MemberSince, StringFormat='{0:MMMM yyyy}'}" FontSize="14" HorizontalOptions="End"/>
                    </Grid>
                    
                    <BoxView HeightRequest="1" BackgroundColor="LightGray"/>
                    
                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                        <Label Grid.Column="0" Text="Last Login:" FontSize="14" TextColor="Gray"/>
                        <Label Grid.Column="1" Text="{Binding LastLogin, StringFormat='{0:MMM dd, yyyy}'}" FontSize="14" HorizontalOptions="End"/>
                    </Grid>
                    
                    <BoxView HeightRequest="1" BackgroundColor="LightGray"/>
                    
                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                        <Label Grid.Column="0" Text="Organization:" FontSize="14" TextColor="Gray"/>
                        <Label Grid.Column="1" Text="{Binding Organization}" FontSize="14" HorizontalOptions="End"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Usage Stats -->
            <Label Text="Usage Statistics" FontSize="20" FontAttributes="Bold"/>
            
            <Frame Padding="15" BackgroundColor="White" BorderColor="LightGray">
                <VerticalStackLayout Spacing="15">
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="15">
                        <Label Grid.Column="0" Text="Videos Analyzed" FontSize="14"/>
                        <Label Grid.Column="1" Text="{Binding VideosAnalyzed}" FontSize="14" FontAttributes="Bold"/>
                    </Grid>
                    
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="15">
                        <Label Grid.Column="0" Text="Documents Processed" FontSize="14"/>
                        <Label Grid.Column="1" Text="{Binding DocumentsProcessed}" FontSize="14" FontAttributes="Bold"/>
                    </Grid>
                    
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="15">
                        <Label Grid.Column="0" Text="Storage Used" FontSize="14"/>
                        <Label Grid.Column="1" Text="{Binding StorageUsed}" FontSize="14" FontAttributes="Bold"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Actions -->
            <Button Text="Edit Profile" 
                    Command="{Binding EditProfileCommand}"
                    BackgroundColor="{StaticResource Primary}"
                    TextColor="White"/>
            
            <Button Text="Change Password" 
                    Command="{Binding ChangePasswordCommand}"
                    BackgroundColor="{StaticResource Secondary}"
                    TextColor="White"/>
            
            <Button Text="Upgrade Subscription" 
                    Command="{Binding UpgradeCommand}"
                    BackgroundColor="Orange"
                    TextColor="White"
                    IsVisible="{Binding IsFreeTier}"/>

        </VerticalStackLayout>
    </ScrollView>
    
</ContentPage>

