{%- comment -%} READING PROGRESS BAR Visual indicator of scroll progress through
article {%- endcomment -%}

<div
  id="reading-progress"
  class="reading-progress"
  role="progressbar"
  aria-label="Reading progress"
  aria-valuenow="0"
  aria-valuemin="0"
  aria-valuemax="100"
  style="
    position: fixed;
    top: 0;
    left: 0;
    width: 0%;
    height: 4px;
    background: linear-gradient(
      90deg,
      var(--color-primary, #dc2626),
      var(--color-accent, #2563eb),
      var(--color-success, #10b981)
    );
    z-index: 9998;
    transition: width 0.1s linear;
    box-shadow: 0 2px 8px rgba(220, 38, 38, 0.5);
  "
></div>

<script>
  (function () {
    const progressBar = document.getElementById("reading-progress");
    let ticking = false;

    function updateReadingProgress() {
      const scrollTop =
        window.pageYOffset || document.documentElement.scrollTop;
      const scrollHeight =
        document.documentElement.scrollHeight -
        document.documentElement.clientHeight;
      const scrollPercent = (scrollTop / scrollHeight) * 100;

      progressBar.style.width = scrollPercent + "%";
      progressBar.setAttribute("aria-valuenow", Math.round(scrollPercent));

      ticking = false;
    }

    function requestTick() {
      if (!ticking) {
        window.requestAnimationFrame(updateReadingProgress);
        ticking = true;
      }
    }

    window.addEventListener("scroll", requestTick, { passive: true });
    window.addEventListener("resize", requestTick, { passive: true });

    // Initial update
    updateReadingProgress();
  })();
</script>

<style>
  @media (prefers-reduced-motion: reduce) {
    .reading-progress {
      transition: none;
    }
  }

  /* Glow effect on progress */
  .reading-progress::after {
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    width: 100px;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6));
    animation: shimmer 2s infinite;
  }

  @keyframes shimmer {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(100%);
    }
  }
</style>
