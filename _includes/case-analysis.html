{% comment %}
  AI-Generated Case Analysis Include
  Displays judicial oversight analysis and journalistic commentary when available
  Automatically hides if no OpenAI API key configured or no analysis exists
  Usage: {% include case-analysis.html %}
{% endcomment %}

{% assign slug = page.url | split:'/' | last | default: page.slug %}
{% assign analysis = site.data.analysis[slug] %}

{% comment %}Only display if analysis data exists - no placeholder messaging{% endcomment %}
{% if analysis and analysis.judicial_oversight or analysis.journalistic_commentary %}
<section class="case-analysis u-bg-surface u-radius-md u-shadow-sm u-py-lg u-px-md u-mb-lg">
  <h2 class="u-text-xl u-text-bold u-mb-md">ðŸ¤– AI-Generated Analysis</h2>
  
  <div class="analysis-disclaimer u-mb-md u-text-sm u-text-muted u-p-xs u-bg-highlight u-radius-sm">
    <p><em>The following analysis was generated using AI and is provided for informational purposes. It should not be considered legal advice or authoritative interpretation. Generated on {{ analysis.generated_at | date: "%B %-d, %Y" }}.</em></p>
  </div>

  {% if analysis.judicial_oversight %}
  <div class="analysis-section judicial-analysis u-mb-md">
    <h3 class="u-text-lg u-text-accent u-mb-xs">ðŸ“‹ Judicial Oversight Perspective</h3>
    <div class="analysis-content u-py-xs u-px-sm u-bg-contrast u-radius-sm">
      {{ analysis.judicial_oversight | markdownify }}
    </div>
  </div>
  {% endif %}

  {% if analysis.journalistic_commentary %}
  <div class="analysis-section journalistic-analysis u-mb-md">
    <h3 class="u-text-lg u-text-accent u-mb-xs">ðŸ“° Reporter's Commentary</h3>
    <div class="analysis-content u-py-xs u-px-sm u-bg-contrast u-radius-sm">
      {{ analysis.journalistic_commentary | markdownify }}
    </div>
  </div>
  {% endif %}

  <div class="analysis-footer u-mt-md u-text-center">
    <p class="analysis-meta u-text-xs u-text-muted">
      <small>Analysis generated by OpenAI GPT model Â· Last updated: {{ analysis.generated_at | date: "%B %-d, %Y at %I:%M %p" }}</small>
    </p>
  </div>
</section>
{% endif %}
